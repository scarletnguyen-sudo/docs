:root{
  --blue:#2563EB;
  --bg:#fff;            --fg:#0f172a;    --muted:#64748b; 
  --card:#fff;          --border:rgba(2,6,23,.12);
  --radius:12px;
  --content-w:1000px;    
  --toc-w:260px;        --side-w:264px; 
  --primary-dark:0 109 199;
  --primary-light:0 109 199;
}
[data-theme="dark"]{
  --bg:#0b0f1a;         --fg:#e2e8f0;    --muted:#94a3b8;
  --card:#0f172a;       --border:rgba(241,245,249,.14);
}

#table-of-contents {
  max-width: 150px;}
}

#content-area {
  max-width: 500px;}
}

/* Typography/layout */
main .markdown{ max-width:var(--content-w); }
.markdown h1{ font-size:40px; line-height:1.5; letter-spacing:-.01em; margin:6px 0 18px; }
.markdown h2{ font-size:21px; margin:28px 0 12px; }
.markdown h3{ font-size:15px; margin:22px 0 8px; }
.markdown p, .markdown li{ font-size:15.5px; line-height:1.7; color:var(--fg); }
.markdown a{ color:var(--blue); text-underline-offset:3px; }
.markdown img{ border-radius:14px; border:1px solid var(--border); box-shadow:0 12px 32px rgba(0,0,0,.12); }

.eps-toc-card{
  position:sticky; top:88px; background:var(--card); border:1px solid var(--border);
  border-radius:var(--radius); padding:12px; height:fit-content;
}
.eps-toc-card .title{ font-size:12px; color:var(--muted); letter-spacing:.04em; text-transform:uppercase; 
  padding:4px 6px 8px; border-bottom:1px solid var(--border); margin-bottom:8px; }
.eps-toc-card a{ display:block; padding:6px; border-radius:8px; color:var(--fg); text-decoration:none; font-size:13px; }

/* Fallback + progressive enhancement cho color-mix */
.eps-toc-card a:hover{ background:rgba(37,99,235,.06); }
@supports (background: color-mix(in oklab, black, white)) {
  .eps-toc-card a:hover{ background:color-mix(in oklab,var(--blue) 7%,var(--card)); }
  .eps-toc-card a.active{ background:color-mix(in oklab,var(--blue) 12%,var(--card)); }
}

/* Footer next/prev */
footer .navigation a{ background:var(--card); border:1px solid var(--border); border-radius:12px; padding:12px 14px; }

/* Buttons */
.eps-nav-actions{ display:inline-flex; align-items:center; gap:8px; margin-left:8px; }
.eps-btn{
  height:32px; padding:8px 12px; border-radius:10px; border:1px solid var(--border);
  background:var(--bg); color:var(--fg);
  font:500 13px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  display:inline-flex; align-items:center; gap:6px; cursor:pointer;
  transition:transform .12s ease, background .12s ease, border-color .12s ease;
}
.eps-btn:hover{ transform:translateY(-1px); }
.eps-btn.done{ background:#2563EB; color:#fff; }

/* Sidebar (chỉ tác dụng nếu DOM có .eps-side) */
.eps-side{ width:var(--side-w); }
.eps-side .group{ margin:8px 0; border-radius:10px; }
.eps-side .group .group-head{
  display:flex; align-items:center; justify-content:space-between; width:100%;
  background:transparent; border:0; padding:8px 10px; border-radius:10px; color:var(--fg);
  font:600 13px/1 Inter,system-ui; cursor:pointer;
}
@supports (background: color-mix(in oklab, black, white)) {
  .eps-side .group .group-head:hover{ background:color-mix(in oklab,var(--blue) 6%,var(--card)); }
}
.eps-side .group .chev{ width:16px; height:16px; transition:transform .15s ease; }
.eps-side .group .group-body{ margin:4px 0 8px 6px; }


/* Accordion: dùng height transition, không display:none */
.eps-side .group-body { overflow:hidden; transition: height 0.25s ease, padding 0.25s ease; }
.eps-side .group.collapsed .group-body { height:0 !important; padding:0; }
.eps-side .group.collapsed .chev{ transform:rotate(-90deg); }

/* Links */
.eps-side .link{
  display:flex; align-items:center; gap:8px; padding:6px 10px; border-radius:8px; color:var(--fg);
  text-decoration:none; font-size:13px;
}
.eps-side .link:hover{ background:rgba(37,99,235,.06); }
@supports (background: color-mix(in oklab, black, white)) {
  .eps-side .link:hover{ background:color-mix(in oklab,var(--blue) 6%,var(--card)); }
  .eps-side .link.active{ background:color-mix(in oklab,var(--blue) 12%,var(--card)); }
}

/* Mobile overlay */
@media (max-width: 1024px){
  .eps-side{ position:fixed; top:64px; bottom:0; left:0; width:min(86vw, 320px);
    background:var(--bg); border-right:1px solid var(--border); padding:8px; z-index:1200;
    transform:translateX(-100%); transition:transform .2s ease; }
  .eps-side.open{ transform:translateX(0); }
  .eps-side-backdrop{ content:""; position:fixed; inset:0; background:rgba(0,0,0,.35); backdrop-filter:saturate(.8) blur(1px); display:none; z-index:1100; }
  .eps-side.open ~ .eps-side-backdrop{ display:block; }
  .eps-mobile-toggle{
    position:fixed; left:12px; top:14px; height:32px; padding:8px 10px; border-radius:10px;
    background:var(--bg); border:1px solid var(--border); z-index:1300; font-size:13px;
  }
}

@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important; }
}