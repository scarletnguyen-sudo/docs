/* ==== Tokens ============================================================= */
:root{
  --blue:#2563EB;
  --bg:#fff;            --fg:#0f172a;    --muted:#64748b; 
  --card:#fff;          --border:rgba(2,6,23,.12);
  --radius:12px;
  --content-w:940px;    /* readable width like Linear */
  --toc-w:260px;        --side-w:264px; 
  --primary-dark:0 109 199;
  --primary-light:0 109 199;
}
[data-theme="dark"]{
  --bg:#0b0f1a;         --fg:#e2e8f0;    --muted:#94a3b8;
  --card:#0f172a;       --border:rgba(241,245,249,.14);
}

/* ==== Page layout / typography ========================================== */
main .markdown{ max-width:var(--content-w); }
.markdown h1{ font-size:34px; line-height:1.2; letter-spacing:-.01em; margin:6px 0 18px; }
.markdown h2{ font-size:22px; margin:28px 0 12px; }
.markdown h3{ font-size:18px; margin:22px 0 8px; }
.markdown p, .markdown li{ font-size:15.5px; line-height:1.7; color:var(--fg); }
.markdown a{ color:var(--blue); text-underline-offset:3px; }
.markdown img{ border-radius:14px; border:1px solid var(--border); box-shadow:0 12px 32px rgba(0,0,0,.12); }

/* Right-rail TOC card */
.eps-toc-card{
  position:sticky; top:88px; background:var(--card); border:1px solid var(--border);
  border-radius:var(--radius); padding:12px; height:fit-content;
}
.eps-toc-card .title{ font-size:12px; color:var(--muted); letter-spacing:.04em; text-transform:uppercase; 
  padding:4px 6px 8px; border-bottom:1px solid var(--border); margin-bottom:8px; }
.eps-toc-card a{ display:block; padding:6px; border-radius:8px; color:var(--fg); text-decoration:none; font-size:13px; }
.eps-toc-card a:hover{ background:color-mix(in oklab,var(--blue) 7%,var(--card)); }
.eps-toc-card a.active{ background:color-mix(in oklab,var(--blue) 12%,var(--card)); }

/* Footer next/prev into tiles */
footer .navigation a{ background:var(--card); border:1px solid var(--border); border-radius:12px; padding:12px 14px; }

/* ==== Top-right cluster ================================================== */
.eps-nav-actions{ display:inline-flex; align-items:center; gap:8px; margin-left:8px; }
.eps-btn{
  height:32px; padding:8px 12px; border-radius:10px; border:1px solid var(--border);
  background:var(--bg); color:var(--fg);
  font:500 13px/1 Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  display:inline-flex; align-items:center; gap:6px; cursor:pointer;
  transition:transform .12s ease, background .12s ease, border-color .12s ease;
}
.eps-btn:hover{ transform:translateY(-1px); }
.eps-btn.done{ background:color-mix(in oklab,var(--blue) 15%,var(--bg)); color:#fff; }
.eps-dropdown{ position:relative; }
.eps-dropdown-menu{
  position:absolute; right:0; top:calc(100% + 6px);
  background:var(--card); border:1px solid var(--border); border-radius:12px; min-width:180px;
  padding:4px 0; display:none; opacity:0; transform:translateY(-4px);
  box-shadow:0 8px 24px rgba(0,0,0,.12); transition:opacity .15s ease, transform .15s ease; z-index:1000;
}
.eps-dropdown.open .eps-dropdown-menu{ display:block; opacity:1; transform:translateY(0); }
.eps-dropdown-menu a{ display:block; padding:9px 12px; color:var(--fg); text-decoration:none; font-size:13px; }
.eps-dropdown-menu a:hover{ background:color-mix(in oklab,var(--blue) 9%,var(--card)); }

/* ==== Sidebar: dropdown groups like Linear =============================== */
.eps-side{ width:var(--side-w); }
.eps-side .group{
  margin:8px 0; border-radius:10px;
}
.eps-side .group .group-head{
  display:flex; align-items:center; justify-content:space-between; width:100%;
  background:transparent; border:0; padding:8px 10px; border-radius:10px; color:var(--fg);
  font:600 13px/1 Inter,system-ui; cursor:pointer;
}
.eps-side .group .group-head:hover{ background:color-mix(in oklab,var(--blue) 6%,var(--card)); }
.eps-side .group .chev{ width:16px; height:16px; transition:transform .15s ease; }
.eps-side .group.collapsed .chev{ transform:rotate(-90deg); }
.eps-side .group .group-body{ margin:4px 0 8px 6px; }
.eps-side .group.collapsed .group-body{ display:none; }

.eps-side .link{
  display:flex; align-items:center; gap:8px; padding:6px 10px; border-radius:8px; color:var(--fg);
  text-decoration:none; font-size:13px;
}
.eps-side .link:hover{ background:color-mix(in oklab,var(--blue) 6%,var(--card)); }
.eps-side .link.active{ background:color-mix(in oklab,var(--blue) 12%,var(--card)); }

/* Collapse/Expand all controls */
.eps-side .side-controls{ display:flex; gap:6px; padding:6px 4px 0 4px; }
.eps-side .side-controls .mini{
  height:28px; padding:6px 10px; border-radius:8px; border:1px solid var(--border);
  background:var(--bg); color:var(--fg); font-size:12px; cursor:pointer;
}

/* Mobile: overlay sidebar toggle */
@media (max-width: 1024px){
  .eps-side{ position:fixed; top:64px; bottom:0; left:0; width:min(86vw, 320px);
    background:var(--bg); border-right:1px solid var(--border); padding:8px; z-index:1200;
    transform:translateX(-100%); transition:transform .2s ease; }
  .eps-side.open{ transform:translateX(0); }
  .eps-side-backdrop{ content:""; position:fixed; inset:0; background:rgba(0,0,0,.35); backdrop-filter:saturate(.8) blur(1px); display:none; z-index:1100; }
  .eps-side.open ~ .eps-side-backdrop{ display:block; }
  .eps-mobile-toggle{
    position:fixed; left:12px; top:14px; height:32px; padding:8px 10px; border-radius:10px;
    background:var(--bg); border:1px solid var(--border); z-index:1300; font-size:13px;
  }
}
/* Sidebar accordion animation */
.eps-side .group-body {
  overflow: hidden;
  transition: height 0.25s ease;
}

.eps-side .group.collapsed .group-body {
  height: 0 !important;
  padding: 0;
}

.eps-side .group-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 600;
  font-size: 13px;
  padding: 8px 10px;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.2s ease;
}

.eps-side .group-head:hover {
  background: color-mix(in oklab, var(--blue) 8%, var(--card));
}

.eps-side .group.collapsed .chev {
  transform: rotate(-90deg);
  transition: transform 0.25s ease;
}

.eps-side .chev {
  width: 14px;
  height: 14px;
  transition: transform 0.25s ease;
}
